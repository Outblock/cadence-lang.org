import{c as g}from"./index-C-0In_at.js";import{r as m}from"./remove-undefined-B_oBVupY-oajMeTFk.js";import"./search-default-Cgr5D8MH.js";import"./main-BXy83AsK.js";import"./search-rY6WEBf1.js";async function k(c,p){const n=g(c),e=[],{index:l="default",client:d,params:o={},tag:s}=p;if(l==="crawler"){const a=await d.search({...o,term:c,where:{category:s?{eq:s.slice(0,1).toUpperCase()+s.slice(1)}:void 0,...o.where},limit:10});if(!a)return e;for(const r of a.hits){const i=r.document;e.push({id:r.id,type:"page",content:n.highlightMarkdown(i.title),url:i.path},{id:"page"+r.id,type:"text",content:n.highlightMarkdown(i.content),url:i.path})}return e}const u={...o,term:c,where:m({tag:s,...o.where}),groupBy:{properties:["page_id"],maxResult:7,...o.groupBy}},h=await d.search(u);if(!h||!h.groups)return e;for(const a of h.groups){let r=!1;for(const i of a.result){const t=i.document;r||(e.push({id:t.page_id,type:"page",content:n.highlightMarkdown(t.title),breadcrumbs:t.breadcrumbs,url:t.url}),r=!0),e.push({id:t.id,content:n.highlightMarkdown(t.content),type:t.content===t.section?"heading":"text",url:t.section_id?`${t.url}#${t.section_id}`:t.url})}}return e}export{k as searchDocs};
